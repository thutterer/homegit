#!/bin/bash

# Simple screen recorder.
#
# Requires:
which ffmpeg > /dev/null || { echo "ffmpeg not found."; exit 1; }
which slop > /dev/null || { echo "slop not found."; exit 1; }

# Records MP4 by default.
# Run `record gif` etc. for other formats.

[ -z "$1" ] && FORMAT="mp4" || FORMAT="$1"
FILENAME="$HOME/Videos/recording_$(date +%s).$FORMAT"


echo "Select a window or area to record:"
slop=$(slop --highlight --format="%x %y %w %h %g %i" --color="0.4,0.4,0.8,0.4" --bordersize=4) || exit 1
read -r X Y W H G ID <<< $slop

echo "Recording... Press Ctrl+C to stop."
ffmpeg           \
  -v quiet       \
  -f x11grab     \
  -s "$W"x"$H"   \
  -i :0.0+$X,$Y  \
  "$FILENAME"

echo "Done."
echo "$FILENAME"
